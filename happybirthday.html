<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Birthday Hannah!</title>
<style>
  body {
    margin: 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    height: 100vh;
    color: white;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    overflow: hidden;
    padding: 20px 0;
    box-sizing: border-box;
  }
  
  h1 {
    font-size: 2.5em;
    margin: 10px 0;
    text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
    animation: glow 2s ease-in-out infinite alternate;
    text-align: center;
    line-height: 1.1;
  }
  
  /* Mobile responsive header */
  @media (max-width: 768px) {
    h1 {
      font-size: 1.8em;
      margin: 5px 0;
      padding: 0 10px;
    }
  }
  
  @media (max-width: 480px) {
    h1 {
      font-size: 1.5em;
      margin: 5px 0;
      white-space: nowrap;
      overflow: hidden;
    }
  }
  
  @keyframes glow {
    from { text-shadow: 3px 3px 6px rgba(0,0,0,0.3), 0 0 10px #fff; }
    to { text-shadow: 3px 3px 6px rgba(0,0,0,0.3), 0 0 20px #fff, 0 0 30px #fff; }
  }
  
  #slideshow-container {
    position: relative;
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    max-width: 90%;
    margin: 10px 0;
    min-height: 0;
  }
  
  #slideshow {
    max-width: 100%;
    max-height: 100%;
    height: auto;
    width: auto;
    border: 5px solid #fff;
    border-radius: 15px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.4);
    object-fit: contain;
    animation: fadeIn 1s ease-in;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
  }
  
  #loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 1.5em;
    display: none;
  }
  
  .controls {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    margin-bottom: 10px;
    background: rgba(0,0,0,0.2);
    padding: 20px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
  }
  
  .button-row {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .volume-control {
    display: flex;
    align-items: center;
    gap: 15px;
    background: rgba(255,255,255,0.1);
    padding: 10px 20px;
    border-radius: 25px;
  }
  
  .volume-slider {
    width: 150px;
    height: 6px;
    -webkit-appearance: none;
    appearance: none;
    background: rgba(255,255,255,0.3);
    border-radius: 3px;
    outline: none;
  }
  
  .volume-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    background: white;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  }
  
  .volume-slider::-moz-range-thumb {
    width: 18px;
    height: 18px;
    background: white;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    border: none;
  }
  
  .volume-label {
    font-size: 14px;
    min-width: 40px;
    text-align: center;
  }
  
  button {
    padding: 12px 24px;
    font-size: 16px;
    cursor: pointer;
    background: rgba(255,255,255,0.9);
    color: #764ba2;
    border: none;
    border-radius: 25px;
    font-weight: bold;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  }
  
  button:hover {
    background: #fff;
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
  }
  
  button:active {
    transform: translateY(0);
  }
  
  #error {
    display: none;
    padding: 20px;
    background: rgba(255,0,0,0.1);
    border: 2px solid #ff4444;
    border-radius: 10px;
    margin: 20px;
  }
  
  .sparkles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
    z-index: -1;
  }
  
  .sparkle {
    position: absolute;
    background: white;
    border-radius: 50%;
    animation: sparkle 3s linear infinite;
  }
  
  @keyframes sparkle {
    0% {
      transform: translateY(100vh) scale(0);
      opacity: 1;
    }
    10% {
      transform: translateY(90vh) scale(1);
    }
    100% {
      transform: translateY(-10vh) scale(0);
      opacity: 0;
    }
  }
</style>
</head>
<body>
<div class="sparkles" id="sparkles"></div>
<h1>üéâ Happy Birthday Hannah! üéÇ</h1>
<div id="slideshow-container">
  <img id="slideshow" src="" alt="Birthday Image">
  <div id="loading">Loading images...</div>
</div>
<audio id="bgMusic" loop></audio>
<div class="controls">
  <div class="button-row">
    <button id="playPauseBtn">‚è∏Ô∏è Pause</button>
    <button id="muteBtn">üîá Mute</button>
  </div>
  <div class="volume-control">
    <span class="volume-label">üîà</span>
    <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="10">
    <span class="volume-label" id="volumeValue">10%</span>
  </div>
</div>
<div id="error">
  <strong>Error:</strong> <span id="errorMsg"></span>
</div>

<script>
  // Configuration
  const repoOwner = 'avatarmanz';
  const repoName = 'rocketleagueelements';
  const folderPath = 'happybirthday';
  const musicFile = 'paralyzer.mp3';
  
  let images = [];
  let currentIndex = 0;
  let interval = null;
  let speed = 5000; // Default 5 seconds
  let isPaused = false;
  
  const slideshow = document.getElementById('slideshow');
  const audio = document.getElementById('bgMusic');
  const loading = document.getElementById('loading');
  const errorDiv = document.getElementById('error');
  const errorMsg = document.getElementById('errorMsg');
  const playPauseBtn = document.getElementById('playPauseBtn');
  const muteBtn = document.getElementById('muteBtn');
  const volumeSlider = document.getElementById('volumeSlider');
  const volumeValue = document.getElementById('volumeValue');
  
  // Create sparkles effect
  function createSparkles() {
    const sparklesContainer = document.getElementById('sparkles');
    for (let i = 0; i < 50; i++) {
      const sparkle = document.createElement('div');
      sparkle.className = 'sparkle';
      sparkle.style.left = Math.random() * 100 + '%';
      sparkle.style.width = Math.random() * 4 + 2 + 'px';
      sparkle.style.height = sparkle.style.width;
      sparkle.style.animationDelay = Math.random() * 3 + 's';
      sparkle.style.animationDuration = (Math.random() * 3 + 3) + 's';
      sparklesContainer.appendChild(sparkle);
    }
  }
  
  // Fetch images from GitHub API
  async function fetchImages() {
    loading.style.display = 'block';
    try {
      // Try GitHub API first
      const response = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${folderPath}`);
      
      if (!response.ok) {
        throw new Error('GitHub API request failed');
      }
      
      const files = await response.json();
      
      // Filter for image files
      const imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp', '.bmp'];
      images = files
        .filter(file => {
          const name = file.name.toLowerCase();
          return imageExtensions.some(ext => name.endsWith(ext)) && !name.includes('happybirthday.html');
        })
        .map(file => `${folderPath}/${file.name}`);
      
      if (images.length === 0) {
        // Fallback: try numbered webp files
        console.log('No images found via API, trying numbered pattern...');
        for (let i = 1; i <= 50; i++) {
          images.push(`${folderPath}/${i}.webp`);
        }
      }
      
      // Shuffle images
      shuffleArray(images);
      
      // Start slideshow
      if (images.length > 0) {
        nextImage();
        startSlideshow();
      } else {
        throw new Error('No images found in the folder');
      }
      
    } catch (error) {
      console.error('Error fetching images:', error);
      
      // Fallback: assume numbered .webp files exist
      console.log('Using fallback image loading...');
      for (let i = 1; i <= 20; i++) {
        images.push(`${folderPath}/${i}.webp`);
      }
      
      shuffleArray(images);
      
      if (images.length > 0) {
        nextImage();
        startSlideshow();
      }
    } finally {
      loading.style.display = 'none';
    }
  }
  
  // Shuffle array
  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }
  
  // Display next image
  function nextImage() {
    if (images.length === 0) return;
    
    const img = new Image();
    img.onload = function() {
      slideshow.src = images[currentIndex];
      slideshow.style.animation = 'none';
      setTimeout(() => {
        slideshow.style.animation = 'fadeIn 1s ease-in';
      }, 10);
    };
    img.onerror = function() {
      console.error(`Failed to load image: ${images[currentIndex]}`);
      // Remove failed image and try next
      images.splice(currentIndex, 1);
      if (images.length > 0) {
        currentIndex = currentIndex % images.length;
        nextImage();
      }
    };
    img.src = images[currentIndex];
    
    currentIndex = (currentIndex + 1) % images.length;
  }
  
  // Start slideshow
  function startSlideshow() {
    if (interval) clearInterval(interval);
    interval = setInterval(nextImage, speed);
    isPaused = false;
    playPauseBtn.innerHTML = '‚è∏Ô∏è Pause';
  }
  
  // Stop slideshow
  function stopSlideshow() {
    if (interval) {
      clearInterval(interval);
      interval = null;
    }
    isPaused = true;
    playPauseBtn.innerHTML = '‚ñ∂Ô∏è Play';
  }
  
  // Setup audio
  function setupAudio() {
    audio.src = `${folderPath}/${musicFile}`;
    audio.volume = 0.5;
    
    // Try to play audio (may be blocked by browser)
    audio.play().catch(e => {
      console.log('Audio autoplay blocked. User interaction required.');
      muteBtn.innerHTML = 'üîä Play';
    });
  }
  
  // Event listeners
  playPauseBtn.addEventListener('click', () => {
    if (isPaused) {
      startSlideshow();
      audio.play();
    } else {
      stopSlideshow();
      audio.pause();
    }
  });
  
  muteBtn.addEventListener('click', () => {
    if (audio.paused) {
      audio.play();
      muteBtn.innerHTML = audio.muted ? 'üîá Unmute' : 'üîä Mute';
    } else {
      audio.muted = !audio.muted;
      muteBtn.innerHTML = audio.muted ? 'üîá Unmute' : 'üîä Mute';
    }
  });
  
  // Volume slider event listener
  volumeSlider.addEventListener('input', (e) => {
    const volume = e.target.value / 100;
    audio.volume = volume;
    volumeValue.textContent = e.target.value + '%';
    
    // Update mute button state if volume is 0
    if (volume === 0) {
      audio.muted = true;
      muteBtn.innerHTML = 'üîá Unmute';
    } else {
      audio.muted = false;
      muteBtn.innerHTML = 'üîä Mute';
    }
  });
  
  // Initialize
  createSparkles();
  fetchImages();
  setupAudio();
  
  // Preload next image for smoother transitions
  setInterval(() => {
    if (images.length > 0 && !isPaused) {
      const nextIndex = (currentIndex + 1) % images.length;
      const preload = new Image();
      preload.src = images[nextIndex];
    }
  }, 1000);
</script>
</body>
</html>
